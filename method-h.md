Название: Системный анализ устойчивости энергетических сетей: индекс H*

© 2025 Рыбаков Павел Игоревич  
Настоящая методика представляет собой отраслевое применение метода H*  
для оценки устойчивости конфигурации энергетических сетей.  
Метод H* разработан автором и основан на спектрально-структурных графовых метриках.  
Работа лицензирована на условиях CC BY-NC-SA 4.0  
https://creativecommons.org/licenses/by-nc-sa/4.0/


Введение: зачем нужен интегральный индекс H* для энергетических сетей

Энергетические сети постоянно меняются: ремонты, аварии, переключения, износ оборудования. В этих условиях ключевой вопрос — не просто “есть ли связь”, а насколько сеть сохраняет свою структурную целостность: где слабые участки, насколько велика избыточность, как близко состояние к точке распада.

Существующие метрики (алгебраическая связность λ₂, размер компонент, изолированные узлы, “визуальная” оценка по SCADA) дают разрозненные сигналы. Они не позволяют получить интегральную числовую оценку текущего состояния всей сети как единого объекта. Это особенно критично для разреженных, неравномерных по весам топологий, которыми и являются реальные энергосети.

> Метод H* предлагает новый подход:
единая метрика, объединяющая спектральные и топологические признаки,
нормированная, устойчивая и пригодная к интерпретации.
Это не замена λ₂, а его развитие — с учётом реальных ограничений отрасли.




---

Что даёт H*

Числовое значение от +∞ (идеальное состояние) до 0 (структурный распад);

Реакция на удаление узлов, ослабление связей, локальные обвалы;

Сравнение текущей топологии с эталонной G₀, без истории, без прогноза, — только по структуре в моменте.



---

Преимущества по сравнению с λ₂:

Не «залипает» в нуле на больших разреженных графах (за счёт нормировки);

Учитывает сразу несколько факторов: связность, размер главной компоненты, степень, спектр;

Масштабно инвариантен — сравним между сетями любого размера.



---

Где применяется:

Раннее выявление деградации структуры;

Оценка последствий ремонтов и временных отключений;

Сравнение альтернативных конфигураций перед внедрением;

Триггерная метрика в автоматическом мониторинге и диспетчеризации.


Метод описан через строгие формулы, примеры и готовый код.
Его задача — перевести “структурное здоровье” сети в понятное и масштабируемое число, которое можно встроить в анализ и принятие решений.


Метод моментной оценки структурной целостности сетей

Аннотация Представлен нормированный интегральный индекс H* для количественной оценки текущего состояния энергетических сетей относительно эталонной конфигурации G0. Индекс основан на спектрально-структурных метриках (lambda2_hat, S_hat, R, kappa_hat) и их геометрическом агрегировании. Документ описывает строгие определения, доказуемые свойства (монотонность, непрерывность, инвариантность к масштабированию весов), численную реализацию и процедуры верификации на типовых сценариях. Метод предназначен для статического (моментного) расчёта без использования истории.

1. Мотивация и постановка задачи

Ограничения разрозненных метрик. Отдельно взятые показатели (алгебраическая связность lambda2, размер крупнейшей компоненты, частные меры центральности) не дают сопоставимого нормированного значения, а их реакции на комбинированные изменения структуры и весов различны.

Требование к решению. Нужен интегральный показатель, который:

нормирован относительно эталона G0;

чувствителен к ослаблению связей и удалению узлов;

монотонно реагирует на любые повреждения;

устойчив численно для разреженных крупномасштабных графов.


2. Эталон, обозначения и базовые конструкции

Эталон: G0=(V0,E0,w0), n0=|V0|, W0 = сумма по E0 w0(e), lambda2(G0)>0.

Текущее состояние: G=(V,E,w), W(G) = сумма по E w(e).

Лапласиан: L(G)=D(G)-A(G), A_ij = w({vi,vj}), D_ii = сумма_j A_ij.

Алгебраическая связность: lambda2(G) — второе по величине собственное значение L(G).

Стабилизатор нормировок: D0 = max(lambda2(G0), 1/n0).

maxdeg(G0) = max по v из V0 deg_G0(v) (взвешенная степень).

Интерпретация весов. Вес ребра — пропускная способность/эквивалентная проводимость линии. Взвешенная степень узла — суммарная инцидентная способность.


3. Нормированные метрики

3.1 Спектральная связность
lambda2_hat(G) = min(1, lambda2(G)/D0).

3.2 Размер крупнейшей компоненты
S_hat(G) = |C_max(G)| / n0.

3.3 Структурная избыточность
R(G) = (1/n0) * сумма по v из V0 [ deg_G(v) / maxdeg(G0) ], где deg_G(v)=0, если v не принадлежит V.

3.4 Сглаженная спектральная характеристика
kappa_hat(G) = 1 - exp(-lambda2(G)/D0).

Границы. Для всех определений: значения лежат в [0,1].


4. Агрегирование и итоговый индекс

4.1 Композитная согласованность
Coh*(G) = (lambda2_hat * S_hat * R * kappa_hat)^(1/4).

4.2 Мера повреждения
sigma*(G) = max( (W0 - W(G))/W0, 1 - lambda2_hat, 1 - S_hat, 1 - R ).

4.3 Индекс состояния
Если sigma*(G) = 0, то H*(G) = +∞; иначе H*(G) = Coh*(G) / (sigma*(G) + eps), где eps = 1/n0^2.


5. Свойства (доказуемые)

5.1 Монотонность. При удалении/ослаблении рёбер и/или удалении узлов: lambda2_hat, S_hat, R, kappa_hat не увеличиваются; sigma* не убывает; откуда H* не возрастает. Основано на свойствах спектра лапласиана (оценки Вейля), определениях S_hat и R.

5.2 Порог распада. Если G несвязен, то lambda2(G)=0 => Coh*(G)=0 => H*(G)=0.

5.3 Масштабная инвариантность. Для любого k>0: замена w -> kw не меняет H благодаря нормировкам относительно G0.

5.4 Непрерывность по весам. При фиксированной топологии H*(G) непрерывен как композиция непрерывных функций от w.

5.5 Верхняя оценка. 0 <= H*(G) <= n0^2 вследствие Coh* <= 1 и (sigma*+eps) >= eps = 1/n0^2.


6. Численная реализация

Ниже приведён опорный (референсный) алгоритм без внешних зависимостей, кроме стандартных библиотек численного линейного алгебраического пакета.

import math
import networkx as nx
import numpy as np
from scipy import sparse
from scipy.sparse.linalg import eigsh

def lambda2_sparse(G: nx.Graph) -> float:
n = G.number_of_nodes()
if n == 0:
return 0.0
# Если граф несвязен, второе собственное значение лапласиана равно 0
if not nx.is_connected(G):
return 0.0
L = nx.laplacian_matrix(G).astype(float)
if n <= 4:
# Для очень малых графов — точный плотный расчёт
Ld = L.toarray()
evals = np.linalg.eigvalsh(Ld)
evals.sort()
return float(max(0.0, evals[1]))
# Итерационный метод для разреженных матриц
evals = eigsh(L, k=2, which='SM', return_eigenvectors=False)
return float(max(0.0, evals[1]))

def compute_h_star(G: nx.Graph,
G0: nx.Graph,
lambda2_0: float,
maxdeg0: float,
W0: float,
n0: int):
D0 = max(lambda2_0, 1.0/n0)
# 1) lambda2 и нормировка
lam2 = lambda2_sparse(G)
lam_hat = min(1.0, lam2 / D0)
# 2) размер крупнейшей компоненты
S_hat = 0.0 if G.number_of_nodes() == 0 else len(max(nx.connected_components(G), key=len)) / n0
# 3) структурная избыточность по V0
R_sum = 0.0
for v in G0.nodes():
deg = G.degree(v, weight='weight') if G.has_node(v) else 0.0
R_sum += deg / maxdeg0
R = max(0.0, min(1.0, R_sum / n0))
# 4) сглаженная спектральная характеристика
kappa_hat = 1.0 - math.exp(-lam2 / D0)
# 5) композитная согласованность
prod = lam_hat * S_hat * R * kappa_hat
coh = 0.0 if prod <= 0.0 else prod ** 0.25
# 6) мера повреждения
W = G.size(weight='weight') if G.number_of_edges() > 0 else 0.0
sigma = max((W0 - W)/W0 if W0 > 0 else 0.0, 1 - lam_hat, 1 - S_hat, 1 - R)
eps = 1.0 / (n0 * n0)
H = float('inf') if sigma == 0.0 else coh / (sigma + eps)
return {
'lambda2_hat': lam_hat,
'S_hat': S_hat,
'R': R,
'kappa_hat': kappa_hat,
'Coh_star': coh,
'sigma_star': sigma,
'H_star': H,
}

Сложность. lambda2: O(m log n) (Ланцош) для разреженных матриц; S_hat, R: O(m+n). Память: пропорциональна количеству рёбер.

Численные примечания. Для сильно разреженных сетей полезно включать переортогонализацию в eigsh; для очень малых графов предпочтителен точный плотный расчёт.


7. Верификация на типовых сценариях

Сетап. Топология на 10 узлов, 12 рёбер; эталон: lambda2(G0)=0.576438, W0=11.5, maxdeg(G0)=3.0, n0=10.

7.1 Последовательное удаление рёбер

Шаг	Операция	lambda2_hat	S_hat	R	H*	Комментарий

0	старт	1.000	1.000	0.767	3.429	эталон
1	удалить (1,7)	0.652	1.000	0.727	1.928	начальная деградация
2	удалить (3,9)	0.609	1.000	0.667	1.634	прогрессирует
3	удалить (2,3)	0.169	1.000	0.587	0.419	критический спад
4	удалить (5,6)	0.000	0.700	0.540	0.000	несвязность

7.2 Целевое удаление узлов

Шаг	Операция	lambda2_hat	S_hat	R	H*	Комментарий

0	старт	1.000	1.000	0.767	3.429	эталон
1	− узел 7	0.342	0.900	0.567	0.709	резкое снижение
2	− узел 3	0.000	0.500	0.373	0.000	несвязность

7.3 Постепенное ослабление рёбер

Шаг	Операция	lambda2_hat	S_hat	R	H*

0	старт	1.000	1.000	0.767	3.429
1	(1,7) × 0.2	0.774	1.000	0.735	2.703
3	(2,3) × 0.4	0.677	1.000	0.645	1.863
5	(0,1) × 0.6	0.650	1.000	0.595	1.578

Вывод. Индекс H* демонстрирует монотонное снижение при последовательных повреждениях и нулевое значение при несвязности.


8. Классификация значений (примерная шкала)

Интервалы могут применяться для описательного отнесения состояния к категориям (устанавливаются пользователем под конкретную сеть):

H* >= 3: номинальное состояние;

1 <= H* < 3: зона внимания;

0 < H* < 1: зона риска;

H* = 0: несвязность.

Шкала приведена как референс и может калиброваться на основе данных конкретной сети.


9. Ограничения и границы применения

Метод оценивает состояние относительно заданного эталона G0.

При изменении топологии возможны скачки значений вследствие дискретной природы S_hat и изменения спектра.

Пороговые значения интервалов H* являются примерными и требуют калибровки под конкретные условия.


10. Воспроизводимость

Для сравнимости расчётов фиксируются: версия кода, параметры эталона (n0, W0, lambda2(G0), maxdeg(G0)), формат входных данных, способ вычисления lambda2 (плотный/разреженный). Рекомендуется сохранять «паспорт расчёта»: контрольные суммы исходных файлов, размеры графа, число компонент, долю изолированных узлов (если имеются), использованные численные толерансы.


Приложение A. Минимальные тесты корректности

1. Эталон совпадает: G = G0 => H* = +∞.

2. Удаление всех рёбер: G = (V, ∅) => H* = 0.

3. Масштабирование весов: замена w -> kw не меняет H.

4. Единичный узел: n0 = 1 => H* корректно ограничен за счёт eps = 1.



Приложение B. Расширения формализма (справочно)

Взвешенные ориентированные графы — через симметризацию весовой матрицы.

Многослойные графы — через супра-лапласиан diag(L_l) + mu*(I ⊗ J).

(Данные расширения приведены справочно; расчёт H* в основном тексте определён для неориентированных взвешенных графов.)

Авторские права и ограничения использования

© 2025 Рыбаков Павел Игоревич. Все права защищены.

Индекс устойчивости формы H* и связанные с ним алгоритмы, формулы и определения являются результатом авторской разработки.

Настоящий документ публикуется в исследовательских и образовательных целях.
Любое коммерческое использование, перепродажа, включение метода в программные продукты, а также применение для оценки или проектирования критических объектов без письменного разрешения автора запрещено.

Контакт для обращений: pavel_rabota1996@mail.ru
ВКонтакте: vk.com/id1059469430
